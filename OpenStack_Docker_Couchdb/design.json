{
  "_id": "_design/language",
  "views": {
    "countTweetByStates": {
      "reduce": "_count",
      "map": "function (doc) {\n  if (doc.place && doc.place.full_name) {\n      var loc_l = doc.place.full_name.toLowerCase();\n      var loc = doc.place.full_name;\n  }\n  if (doc.user && doc.user.location) {\n      var loc2_l = doc.user.location.toLowerCase();\n      var loc2 = doc.user.location;\n  }\n  var stateNotFound = true;\n  var allLoc = ['victoria', 'act', 'new south wales', 'northern territory', 'queensland', 'tasmania', 'western australia', 'south australia'];\n  var abbres = {'VIC': 'victoria', 'NSW': 'new south wales', 'NT': 'northern territory', 'QLD': 'queensland', 'TAS': 'tasmania', 'WA': 'western australia', 'SA': 'south australia'};\n  for (var i=0; i < allLoc.length; i++) {\n      if ( ( loc_l && loc_l.includes(allLoc[i]) ) || ( loc2_l && loc2_l.includes(allLoc[i]) ) ) {\n          // var thisLoc = allLoc[i];\n          stateNotFound = false;\n          emit(allLoc[i], 1);\n      }\n  }\n  if (stateNotFound) {\n      for (var abbre in abbres) {\n          if  ( ( loc && loc.includes(abbre) ) || ( loc2 && loc2.includes(abbre) ) ) {\n              // var thisLoc = abbres[abbre];\n              emit(abbres[abbre], 1);\n          }\n      }\n  }\n  // console.log(thisLoc);\n}"
    },
    "vulgarWordFreq": {
      "map": "function (doc) {\n  if (doc.place && doc.place.full_name) {\n      var loc_l = doc.place.full_name.toLowerCase();\n      var loc = doc.place.full_name;\n  }\n  if (doc.user && doc.user.location) {\n      var loc2_l = doc.user.location.toLowerCase();\n      var loc2 = doc.user.location;\n  }\n  var stateNotFound = true;\n  var abbres = {'act': 'ACT', 'victoria': 'VIC', 'new south wales': 'NSW', 'northern territory': 'NT', 'queensland': 'QLD', 'tasmania': 'TAS', 'western australia': 'WA', 'south australia': 'SA'};\n  var thisLoc = null;\n  for (var abbre in abbres) {\n      if  ( ( loc_l && loc_l.includes(abbre) ) || ( loc2_l && loc2_l.includes(abbre) ) ) {\n          thisLoc = abbres[abbre];\n          stateNotFound = false;\n      }\n  }\n  if (stateNotFound) {\n      for (var abbre1 in abbres) {\n          if  ( ( loc && loc.includes(abbres[abbre1]) ) || ( loc2 && loc2.includes(abbres[abbre1]) ) ) {\n              thisLoc = abbres[abbre1];\n              stateNotFound = false;\n          }\n      }\n  }\n  // console.log(thisLoc);\n  \n  if (thisLoc && doc && doc.tag && doc.tag.vulgar_words && doc.tag.vulgar_words == 'True') {\n      if (doc.tag.vulgar_words_used) {\n          var vulgar_words_used = doc.tag.vulgar_words_used;\n          var vulgar_words_freqs = {};\n          // console.log(vulgar_words_used);\n          for (var j=0; j < vulgar_words_used.length; j++) {\n              var vulw = vulgar_words_used[j];\n              if (Object.keys(vulgar_words_freqs).includes(vulw)) {\n                  vulgar_words_freqs[vulw] += 1;\n              } else {\n                  vulgar_words_freqs[vulw] = 1;\n              }\n          }\n          // console.log(vulgar_words_freqs);\n          emit(thisLoc, vulgar_words_freqs);\n      } else {\n          console.log('error1');\n      }\n    } else {\n        console.log('error2');\n    }\n}",
      "reduce": "function(keys, values, rereduce) {\n  var all_freqs = {};\n  for(var i = 0; i < values.length; i++) {\n      var vulgar_words_freqs = values[i];\n      // console.log(vulgar_words_freqs);\n      for(var vulw in vulgar_words_freqs) {\n          var freq = vulgar_words_freqs[vulw];\n          if (Object.keys(all_freqs).includes(vulw)) {\n              all_freqs[vulw] += freq;\n          } else {\n              all_freqs[vulw] = freq;\n          }\n        }\n  }\n  // console.log(all_freqs);\n  // var array = [];\n  // for (var word in all_freqs) {\n  //   array.push({text: word, value: all_freqs[word]});\n  // }\n  return all_freqs;\n  // return array;\n}"
    },
    "hashtagFreq": {
      "map": "function (doc) {\n  if (doc.place && doc.place.full_name) {\n      var loc_l = doc.place.full_name.toLowerCase();\n      var loc = doc.place.full_name;\n  }\n  if (doc.user && doc.user.location) {\n      var loc2_l = doc.user.location.toLowerCase();\n      var loc2 = doc.user.location;\n  }\n  var stateNotFound = true;\n  var abbres = {'act': 'ACT', 'victoria': 'VIC', 'new south wales': 'NSW', 'northern territory': 'NT', 'queensland': 'QLD', 'tasmania': 'TAS', 'western australia': 'WA', 'south australia': 'SA'};\n  var thisLoc = null;\n  for (var abbre in abbres) {\n      if  ( ( loc_l && loc_l.includes(abbre) ) || ( loc2_l && loc2_l.includes(abbre) ) ) {\n          thisLoc = abbres[abbre];\n          stateNotFound = false;\n      }\n  }\n  if (stateNotFound) {\n      for (var abbre1 in abbres) {\n          if  ( ( loc && loc.includes(abbres[abbre1]) ) || ( loc2 && loc2.includes(abbres[abbre1]) ) ) {\n              thisLoc = abbres[abbre1];\n              stateNotFound = false;\n          }\n      }\n  }\n  // console.log(thisLoc);\n  \n  if (thisLoc && doc && doc.entities && doc.entities.hashtags) {\n      var hashtags_freqs = {};\n      var hashtags = doc.entities.hashtags;\n      for (var j=0; j < hashtags.length; j++) {\n          var hashtag = hashtags[j].text;\n          if (Object.keys(hashtags_freqs).includes(hashtag)) {\n              hashtags_freqs[hashtag] += 1;\n          } else {\n              hashtags_freqs[hashtag] = 1;\n          }\n      }\n      emit(thisLoc, hashtags_freqs);\n  } \n  // else {\n  //     console.log('error1');\n  // }\n    \n}",
      "reduce": "function(keys, values, rereduce) {\n  var all_freqs = {};\n  for(var i = 0; i < values.length; i++) {\n      var vulgar_words_freqs = values[i];\n      // console.log(vulgar_words_freqs);\n      for(var vulw in vulgar_words_freqs) {\n          var freq = vulgar_words_freqs[vulw];\n          if (Object.keys(all_freqs).includes(vulw)) {\n              all_freqs[vulw] += freq;\n          } else {\n              all_freqs[vulw] = freq;\n          }\n        }\n  }\n  // console.log(all_freqs);\n  // var array = [];\n  // for (var word in all_freqs) {\n  //   array.push({text: word, value: all_freqs[word]});\n  // }\n  return all_freqs;\n  // return array;\n}"
    }
  }
}